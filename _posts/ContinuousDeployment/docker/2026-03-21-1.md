---
layout: default_post
title: "0012. 避開 Snap 版 Docker 的路徑掛載陷阱"
excerpt: "Docker"
tags: 
  - "Docker"
  - "Docker-Compose"
  - "Container"
  - "Ubuntu"
  - "Linux"    
---

<div class="summary">
<br/>應用所需：已安裝 Docker
<br/>解決問題：檔案確實存在，為何 docker build 時出現 invalid mount config: bind source path does not exist
<br/>範例檔案：<a href="https://github.com/gotoa1234/MyBlogExample/tree/main/StaticWeb">本篇範例代碼</a>
<br/>相關參考：<a href="https://gotoa1234.github.io//2026/03/14/1.html">0023. Jenkins 如何在限制中完成自動化 : 動態讀取 Git JSON 機器清單的 Jenkins 佈署方案</a>，中出現的延伸問題
<br/>基本介紹：本篇分為 3 部分。
<br/>第一部分：問題描述
<br/>第二部分：解決方法
<br/>第三部分：驗證結果
</div>

<div class="title">
    <br/><hr class="titleinner">
	<span></span>
	<hr class="titleinner"><br/>
</div>

<br/><br/>
<h1>第一部分：問題描述</h1>

<h2>Step 1：運行範例代碼 - 出現錯誤</h2>
<a href="https://gotoa1234.github.io//2026/03/14/1.html">0023. Jenkins 如何在限制中完成自動化 : 動態讀取 Git JSON 機器清單的 Jenkins 佈署方案</a>，中出現的延伸問題
<br/>建置過程出現以下錯誤：

``` Markdown
docker: Error response from daemon: invalid mount config for type "bind": bind source path does not exist: /var/dockervolumes/GetDockerContainerEnvironmentParameterExample/appsettings.json.
```

<br/>依照描述，會推論檔案不存在於 **/var/dockervolumes/GetDockerContainerEnvironmentParameterExample/appsettings.json**
<br/> <img src="/assets/image/ContinuousDeployment/docker/2026_03_21/001.png" alt="" width="70%" height="70%" />
<br/><br/>


<h2>Step 2：檢查檔案</h2>
到目標主機檢查，確認檔案也存在，因此不可能是 ** not exist**

``` Markdown
ls /var/dockervolumes/GetDockerContainerEnvironmentParameterExample/appsettings.json
```

<br/> <img src="/assets/image/ContinuousDeployment/docker/2026_03_21/002.png" alt="" width="70%" height="70%" />
<br/><br/>


<h2>Step 3：問題原因</h2>
這屬於 Snap 版 Docker 的路徑掛載陷阱

``` Shell
Ubuntu 等系統若透過 snap install docker 安裝，Docker 會運行在沙盒環境中，受限於 AppArmor 政策，無法直接掛載 /var 或 /home 以外的非標準系統路徑。
```

<br/>通常實務上會避免 **避開 Snap 或 Flatpak。雖然它們安裝方便** 但常常會有非預期的問題
<br/><br/>



<br/><br/>
<h1>第二部分：解決方法</h1>

<h2>Step 1：解決方法</h2>
解除安裝 Snap 版本，並依照 Docker 官方文件 (Docker Engine) 的方式透過 apt-get 安裝。
<br/>1. 解除安裝 snap docker：

``` shell
sudo snap remove docker
```

<br/>2. 安裝官方 Docker 

``` shell
curl -fsSL https://get.docker.com | sh
```

<br/>3. 啟動 Docker 進程

``` shell
sudo systemctl start docker
```

<br/>4. 檢查是否正確啟動

``` shell
docker info | grep "Docker Root Dir"
```

<br/>最終，若成功安裝會出現 **Server: Docker Engine ...**
<br/><br/>






<br/><br/>
<h1>第三部分：驗證結果</h1>


<h2>Step 1：驗證結果 - 解決</h2>
再次重新部署，可以發現恢復正常，不再報錯，官方 docker 可以正常訪問 /var 路徑下的資料夾
<br/> <img src="/assets/image/ContinuousDeployment/docker/2026_03_21/003.png" alt="" width="70%" height="70%" />
<br/><br/>

