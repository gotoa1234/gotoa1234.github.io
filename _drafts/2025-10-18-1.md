---
layout: default_post
title: "0102. ASP.NET Core 更有效率的 OCR ： IronOcr 商用軟體實作"
excerpt: "C# 學習筆記"
tags:
  - "Tesseract"
  - "Tesseract OCR"
  - "IronOcr"
  - "OCR"
  - "Asp.NET Core"
  - "Asp.NET Core Web MVC"
  - "C#"  
  - "Web"
---

<div class="summary">
<br/>範例所需：1. Visual Studio 2022 以上版本
<br/>&emsp;&emsp;&emsp;&emsp;&emsp;2. IronOCR (Ver：2050.8.6)
<br/>範例檔案：<a href="https://github.com/gotoa1234/MyBlogExample/tree/main/IronOcrForDotnetExample/IronOcrForDotnetExample">本篇範例代碼</a>
<br/>相關參考：<a href="https://gotoa1234.github.io/2025/10/04/1.html">0101. ASP.NET Core 整合 Tesseract OCR：從原始圖片到文字識別的完整實作</a>
<br/>解決問題：Tesseract OCR 在低解析度圖片時辨識效果較差，可採用付費的 IronOCR 解決此問題
<br/>基本介紹：本篇分為四大部分。
<br/>第一部分：IronOcr 介紹
<br/>第二部分：IronOcr 取得 Key
<br/>第三部分：範例專案說明 + 實作
<br/>第四部分：DEMO 成果
</div>

<div class="title">
    <br/><hr class="titleinner">
  <span></span>
  <hr class="titleinner"><br/>
</div>

<br/><br/>
<h1>第一部分：IronOcr 介紹</h1>


<h2>Step 1： T</h2>


``` markdown
Tesseract是光學字元辨識引擎，支援多種作業系統。Tesseract是基於Apache授權條款的自由軟體，自2006年起由Google贊助開發。

2006年，Tesseract被認為是最精準的開源光學字元辨識引擎之一。
```

<br/><img src="/assets/image/LearnNote/2025_10_18/001.png" alt="" width="100%" height="100%" />
<br/><br/>




<br/><br/>
<h1>第二部分：IronOcr 取得 Key</h1>

<h2>Step 1：登入官網</h2>
進入官網連結後，依序填入資訊

{:class="table table-bordered"}
| 1. 輸入自己的信箱 (範例用 Gmail) |
| 2. 送出 |

<br/><img src="/assets/image/LearnNote/2025_10_18/001.png" alt="" width="100%" height="100%" />
<br/><br/>

<h2>Step 2：</h2>
若可以正常送出，則出現下圖資訊
<br/><img src="/assets/image/LearnNote/2025_10_18/002.png" alt="" width="100%" height="100%" />
<br/><br/>

<h2>Step 3：打開信箱</h2>
依照地區的不同，收到信的時間可能或長或短，將以下的**金鑰** 複製，後續代碼中會用到

<br/><img src="/assets/image/LearnNote/2025_10_18/003.png" alt="" width="100%" height="100%" />
<br/><br/>




<br/><br/>
<h1>第三部分：範例專案說明 + 實作</h1>

<h2>Step 1： 範例專案說明 </h2>
打開<a href="https://github.com/gotoa1234/MyBlogExample/tree/main/IronOcrForDotnetExample/IronOcrForDotnetExample">本篇範例代碼</a>後，架構基本分成以下：

{:class="table table-bordered"}
| 1. 初始化配置  | ： | 依賴注入用到的 Service | 
| 2. 業務邏輯服務  | ： | 實現如何操作 IronOCR 擷取圖片的方法  | 
| 3. 靜態協助  | ： | 讀取對應圖片檔案的名稱，靜態變數 | 
| 4. 控制器  | ： | 將使用 IronOCR 擷取的結果傳至 Web 檢視器 | 
| 5. Web 檢視器  | ： | 展示 IronOCR 擷取圖片的差異 | 

<br/><img src="/assets/image/LearnNote/2025_10_18/008.png" alt="" width="40%" height="40%" />
<br/><br/>

<h2>Step 2： Nuget 安裝套件</h2>
先從 Nuget 上安裝 IronOCR 套件，這邊安裝 2025.8.6 版本

``` Markdown
IronOcr
```

<br/><img src="/assets/image/LearnNote/2025_10_18/004.png" alt="" width="100%" height="100%" />
<br/><br/>

<h2>Step 2： 安裝語言包</h2>
與 Tesseract 的安裝語言包的方式不太一樣，IronOcr 支持 Nuget 安裝語言包
<br/>分別安裝以下簡體中文，本篇範例會用到
<br/>※英文是預設不用安裝

``` Markdown
IronOcr.Languages.Chinese
IronOcr.Languages.ChineseSimplified
```

<br/><img src="/assets/image/LearnNote/2025_10_18/004_1.png" alt="" width="100%" height="100%" />
<br/><img src="/assets/image/LearnNote/2025_10_18/004_3.png" alt="" width="100%" height="100%" />
<br/><br/>


<h2>Step 3： 安裝完成 - 提供使用說明</h2>
安裝完 IronOCR 套件後，會預設開啟 C# 的使用範例說明，但預設說明沒有使用**金鑰的方法**
<br/>後面代碼範例會繼續說明如何使用金鑰
<br/><img src="/assets/image/LearnNote/2025_10_18/004_2.png" alt="" width="100%" height="100%" />
<br/><br/>

<h2>Step 4：範例代碼說明</h2>
以下為對應代碼 IronOcrService.cs 流程，有 4 大項步驟
<br/> IronOcr 最大的優勢是專門為 Ocr 對象進行圖片處理

{:class="table table-bordered"}
| 1. 準備好金鑰  | ： | 將註冊拿到的金鑰貼上 | 
| 2. 設定金鑰  | ： | 設定金鑰的方式  | 
| 3. 可以選擇多個語言，選擇英文 + 簡中  | ： |  語言包可以用疊加的方式，順序很重要，會影響辨識語言優先級 | 
| 4. OCR 工作  | ： | 貼心的圖片處理 + OCR | 

<br/>

``` C#
    public class IronOCRService : IIronOCRService
    {
        // 1. 準備好金鑰
        private readonly string _IronKey = $@"IRONSUITE.xxxxxxxxx";

        private readonly ILogger<IronOCRService> _logger;

        public IronOCRService(ILogger<IronOCRService> logger)
        {
            _logger = logger;
        }

        public string IronOCR()
        {
            // 2. 設定金鑰
            IronOcr.License.LicenseKey = _IronKey;
            var ocr = new IronTesseract();
            var ocrResult = string.Empty;

            // 3. 可以選擇多個語言，選擇英文 + 簡中
            ocr.Language = OcrLanguage.EnglishBest; 
            ocr.AddSecondaryLanguage(OcrLanguage.ChineseSimplifiedBest);

            try
            {
                // 4. 開始 OCR 工作
                using (var ocrInput = new OcrInput())
                {
                    // 4-1. 設定 IronOCR 會為圖片處理以下工作 
                    ocrInput.DeNoise();// a. 去除雜訊
                    ocrInput.Deskew(); // b. 自動校正傾斜
                    ocrInput.Invert(); // c. 反色 (黑底白字)                                       
                    
                    // 4-2. 執行 OCR (會套用上述的圖片處理)
                    ocrInput.LoadImage("div.png");
                    ocrResult = ocr.Read(ocrInput).Text;                    
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex);
            }
            return ocrResult;
        }
    }
```

<br/><br/>





<br/><br/>
<h1>第四部分：DEMO 成果</h1>

<h2>Step 1：經典 Tesseract</h2>


``` C#

```

<br/><img src="/assets/image/LearnNote/2025_10_18/001.png" alt="" width="100%" height="100%" />
<br/><br/>
