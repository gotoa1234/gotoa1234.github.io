---
layout: default_post
title:  "0020. 打造穩定的 TypeScript CI/CD 管線：Jenkins 實務整合"
excerpt: "Jenkins"
tags: 
- "Jenkins"
- "Continuous Integration(CI)"
- "Continuous Deployment(CD)"
- "Docker"
- "Docker-Compose"
- "Container"
- "Ubuntu"
- "Linux"
- "Windows"
- "Jenkins"
- "DotNETSDK"
---

<div class="summary">
<br/>應用所需：1. jenkins 主機
<br/>&emsp;&emsp;&emsp;&emsp;&emsp;2. 已安裝 Docker-Compose Ubuntu 主機 
<br/>解決問題：1.
<br/>&emsp;&emsp;&emsp;&emsp;&emsp;2.
<br/>範例專案：<a href="https://github.com/gotoa1234/MyBlogExample/tree/main/JenkinsDockerComposeExample">範例腳本</a>
<br/>基本介紹：本篇分為 4 大部分。
<br/>第一部分：為什麼要將 TypeScript 專案自動建置
<br/>第二部分：範例專案(撰寫 tsconfig.json)
<br/>第三部分：用 npx tsc 進行 TypeScript 編譯
<br/>第四部分：自動部署（可選：如複製到某資料夾 / FTP / Docker 等）

</div>

<div class="title">
    <br/><hr class="titleinner">
	<span></span>
	<hr class="titleinner"><br/>
</div>



<br/><br/>
<h1>第一部分：問題描述</h1>

<h2>Step 1：舊版遷移到新版 Jenkins - 遭遇問題</h2>
需求上，會需要將舊版的 Windows Jenkins 機器淘汰，轉移到新版 Jenkins 並且使用 Ubuntu 作業系統安裝

<br/> <img src="/assets/image/ContinuousDeployment/Jenkins/2025_07_12/024.png" alt="" width="50%" height="50%" />
<br/>
<br/>此時不可能讓我們直接將舊的 Windows Jenkins 的所有內容貼上到Jenkins(Ubuntu 容器化) 的新機器上
<br/>首先面臨的問題就是**作業系統不同**與**版本差異** ，這就是要克服的部分。將在第二、第三部分說明
<br/><br/>


<br/><br/>
<h1>第二部分：各轉移項目 - 安全的做法</h1>

<h2>Step 1：版本落差太大 - 跨平台遷移的風險</h2>
以下是基本跨平台 **Windows 轉移到 Linux** 上的風險差異

{:class="table table-bordered"}
| 1. 檔案路徑格式 | ： | Windows 使用 \，Linux 使用 /，某些插件或 job config.xml 會儲存硬編碼路徑。 |
| 2. 憑證加密差異 | ： | Jenkins Credentials 加密依賴 OS 上的 secrets/master.key 與環境，跨平台可能無法解密。 |
| 3. 權限問題 | ： | Windows 檔案系統權限與 Linux 完全不同，導致 container 內部讀寫異常。 |
| 4. 插件相依性 | ： | 某些插件只支援某 OS，例如某些用到 PowerShell 或 bat 的 plugin 會在 Linux 掛掉。 |
| 5. 工具安裝 | ： | 工具（JDK、Maven）若原本配置為 Windows 路徑，會在 Linux 找不到可執行檔。 |

<br/> <img src="/assets/image/ContinuousDeployment/Jenkins/2025_07_12/001.png" alt="" width="50%" height="50%" />
<br/><br/>






<br/><br/>
<h1>第三部分：舊版遷移到新版 Jenkins </h1>

<h2>Step 1：搬移項目說明</h2>
手動重建的項目會直接忽略，會依序對這些項目做搬移說明：

{:class="table table-bordered"}
| 1. Views 視景 | **直接將 config.xml 檔案複製**  |
| 2. Users 帳號 | **將 users 資料夾全部複製**   | 

<br/> 以下 2 項會在 **第四部分：建立可復現的 Jenkins 容器** 說明：

{:class="table table-bordered"}
| 1. Plugins 外掛插件 | **透過 plugin.txt 安裝** |
| 2. Tools 工具配置 | **DockerFile 安裝**  |

<br/><br/>







<br/><br/>
<h1>第四部分：建立可復現的 Jenkins 容器</h1>

<h2>Step 1：新機器上 - 建立 DockerFile 與 DockerCompose</h2>
在 Ubuntu 宿主機上，開啟一個資料夾並且建立 **dockerfile** 與 **docker-comopese.yml** 檔案
<br/>※內容可從<a href="https://github.com/gotoa1234/MyBlogExample/tree/main/JenkinsDockerComposeExample">範例腳本</a>
<br/> <img src="/assets/image/ContinuousDeployment/Jenkins/2025_07_12/010.png" alt="" width="50%" height="50%" />
<br/><br/>
