---
layout: default_post
title: "0099. Google 提供的機器人防護服務 - 實作導入 reCAPTCHA 到 C# 網站"
excerpt: "C# 學習筆記"
tags:
  - "Asp.NET Core"
  - "reCAPTCHA"
  - "Google Cloud Platform"
  - "Asp.NET Core"
  - "Asp.NET Core Web MVC"
  - "C#"
  - "Azure"
  - "Selenium"
  - "Web"
---

<div class="summary">
<br/>範例所需： 1. Visual Studio 2022 Asp.net Core
<br/>&emsp;&emsp;&emsp;&emsp;&emsp; 2. 開通 Google Cloud Platform 便於管理 reCAPTCHA 金鑰設定 (要有 Google 帳號啟用)
<br/>範例檔案：<a href="https://github.com/gotoa1234/MyBlogExample/tree/main/GoogleCloudStorageSupportS3APIExample">本篇範例代碼</a>
<br/>解決問題：如何啟用 Google 的 reCAPTCHA 並且導入 Asp.net Core C# Web ，達到防止機器人攻擊的效果，保護自己的網站
<br/>&emsp;&emsp;&emsp;&emsp;&emsp; 2. 2025/8月為止，說明當前 Google reCAPTCHA 的 3 種類型導入與用法
<br/>基本介紹：本篇分為六大部分。
<br/>第一部分：reCAPTCHA 介紹
<br/>第二部分：啟用配置 & 管理金鑰
<br/>第三部分：範例專案架構
<br/>第四部分：reCAPTCHA DEMO - 隱形 reCAPTCHA 標記
<br/>第五部分：reCAPTCHA DEMO -「我不是機器人」核取方塊
<br/>第六部分：reCAPTCHA DEMO - 以分數為依據 (v3)
</div>

<div class="title">
    <br/><hr class="titleinner">
	<span></span>
	<hr class="titleinner"><br/>
</div>

<br/><br/>

<h1>第一部分：reCAPTCHA 介紹</h1>

<h2>Step 1： 介紹</h2>
Google 官方的<a href="https://cloud.google.com/recaptcha/docs/overview?hl=zh-tw">reCAPTCHA 總覽</a>

```Markdown
reCAPTCHA 採用進階風險分析技術偵測詐欺行為，您可以透過 reCAPTCHA 保護網站或行動應用程式免受垃圾內容和濫用行為侵擾，並偵測其他類型的詐欺活動，例如憑證填充、帳戶盜用 (ATO) 和自動建立帳戶。
reCAPTCHA 提供更精細的分數、高風險事件的原因代碼、行動應用程式 SDK、密碼外洩偵測、多重驗證 (MFA)，以及調整網站專屬模型的功能，可保護企業業務。
```

<br/>目的就是保護自己架設的網站、應用程式。|
<br/>本篇目標：針對自己的網站，分別說明 reCAPTCHA 3種驗證方式的用法與防護方式、C# DEMO 實作 (Checkbox , Invisible , Score)
<br/><img src="/assets/image/LearnNote/2025_09_20/000.png" alt="" width="70%" height="70%" />
<br/><br/>

<h2>Step2：可用方案 & 收費方式</h2>
可參考 Google 的<a href="https://cloud.google.com/recaptcha/docs/billing-information?hl=zh-tw#how-it-works">付費方式</a>分成 3 種方案類型
<br/>

{:class="tabletable-bordered"}
| reCAPTCHAEssentials | reCAPTCHAStandard | reCAPTCHAEnterprise |
| ---- | ------------------- | ----------------- |
| 最基礎版 | 標準版 | 企業版 |
| 未註冊 Google 帳戶 | 已註冊帳戶自動使用 | 花費更多錢升級 |
| 10,000 次免費評估 | 10,000 次免費評估 | 10,000 次免費評估 |
| 超過 10000 次停用 | 超過 10000 次可付 $8 最大可達 100,000 次 | 同 Standard ，超過 100,000 每次會收 0.001$ |
| | 超過 100,000 次自動升級到企業版 | |
| 基礎功能 | 標準功能 | |
| 不用繳費 | 月付 | 可以跟 Google 談多久付一次錢 |

<br/>
<br/><img src="/assets/image/LearnNote/2025_09_20/000.png" alt="" width="70%" height="70%" />
<br/><br/>

<h2>Step 3： 方案提供功能補充說明</h2>
在Google的<ahref="https://cloud.google.com/recaptcha/docs/compare-tiers?hl=zh-tw">reCAPTCHA參考指南</a>裡，列出3種方案類型功能說明：
<br/>這邊簡要補充各功能具體意義，詳細說明建議還是參考上面官方文件：

{:class="tabletable-bordered"}
| 功能 | 功能說明 |
| ---- | ---- |
| **視覺挑戰支援** | 指在驗證失敗或風險過高時，會展示圖片驗證挑戰（例如選擇交叉口圖片），以確保是真人操作。 |
| **網路應用程式防火牆防護** | 網站前面加一層安全防護網，會幫你擋掉惡意流量（像是爬蟲、DDoS 攻擊） |  
| **支援多重驗證 (MFA) (預先發布版)** | 除了密碼，還要多一個驗證步驟（EX: 簡訊 OTP 或 Email 驗證碼），降低帳號被盜的風險 |
| **密碼防護** | 使用者密碼有沒有出現在已知的資料外洩名單 |  
| **帳戶防護工具** | 若判定風險高，可要求額外驗證或暫時鎖定帳號 |
| **漫遊器分數精細程度** | 標準版分數等級只有（0.1, 0.3, 0.7, 0.9） ; 企業版可以更精細。便於使用者調整防禦策略 |
| **簡訊費用詐欺防護功能** | 防止惡意程式自動發送大量 SMS 驗證碼，導致你支付昂貴的簡訊費用 |
| **防範付款詐欺** | 配合分數與行為分析，提前阻擋可疑交易。 |
| **原因代碼** | 除了分數，還會告訴你「為什麼」分數低。 (EX: 部分 IP 來自高風險國家、裝置異常、或短時間大量操作) |  
| **使用 Annotation API 提供評估意見** | 可以回傳自己對該次驗證的評價（真人/機器人）給 Google，幫助它的 AI 變得更精準。 |
| **SLA** | Google 對你保證的服務可用性，例如「99.9% 正常運作時間」。 未達到，可以向 Google 進行索賠 |  
| **SLO** | SLA 是合約責任，SLO 是內部 KPI，達不到 Google 也不一定賠償。 |

<br/>
<br/><img src="/assets/image/LearnNote/2025_09_20/000.png" alt="" width="70%" height="70%" />
<br/><br/>

<h2>Step 4： 網站可啟用驗證方式與應用場景</h2>
以下是 3 種驗證方式與適用場景：

{:class="tabletable-bordered"}
| 項目\驗證方式           | **v2 Checkbox**         | **Invisible reCAPTCHA (v2)**   | **v3（分數評估）**                   |
| ------------ | ----------------------- | ------------------------------ | ------------------------------ |
| **使用者互動**    | 需點「我不是機器人」核取方塊，有時出現圖片驗證 | 無需點擊核取框，隱形觸發驗證 (觸發才有操作)                | 完全無使用者操作                       |
| **UX 體驗**    | 介入性中：有視覺挑戰，減少衝擊         | 較無介入：對使用者更友善                   | 零中斷用戶體驗                        |
| **防機器人機制說明** | 使用行為分析 + 圖像驗證挑戰拦截機器人    | 背景行為風險評估，自動根據風險可能再顯示驗證畫面       | 背景分析使用者行為，回傳 0–1 分數，自訂門檻採取額外動作 |
| **適合應用場景**   | 表單、註冊、留言板的快速實作防護        | 需要平滑驗證流程的平台（如登入、提交）            | 大型網站、高流量平台，自己的網站需彈性策略防護             |

<br/>
<br/><br/>

<h1>第二部分：啟用配置 & 管理金鑰</h1>

<h2>Step 1： 目標</h2>
<br/>
<br/><img src="/assets/image/LearnNote/2025_09_20/000.png" alt="" width="70%" height="70%" />
<br/><br/>

<br/><br/>

<h1>第三部分：範例專案架構</h1>

<h2>Step 1： 目標</h2>
<br/>
<br/><img src="/assets/image/LearnNote/2025_09_20/000.png" alt="" width="70%" height="70%" />
<br/><br/>

<br/><br/>

<h1>第四部分：reCAPTCHA DEMO - 隱形 reCAPTCHA 標記</h1>

<h2>Step 1： 目標</h2>
<br/>
<br/><img src="/assets/image/LearnNote/2025_09_20/000.png" alt="" width="70%" height="70%" />
<br/><br/>

<br/><br/>

<h1>第五部分：reCAPTCHA DEMO -「我不是機器人」核取方塊</h1>

<h2>Step 1： 目標</h2>
<br/>
<br/><img src="/assets/image/LearnNote/2025_09_20/000.png" alt="" width="70%" height="70%" />
<br/><br/>

<br/><br/>

<h1>第六部分：reCAPTCHA DEMO - 以分數為依據 (v3)</h1>

<h2>Step 1： 目標</h2>
<br/>
<br/><img src="/assets/image/LearnNote/2025_09_20/000.png" alt="" width="70%" height="70%" />
<br/><br/>

<a href="https://www.google.com/recaptcha/">管理 reCAPTCHA</a>
