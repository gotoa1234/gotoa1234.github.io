---
layout: default_post
title:  "0013. Ubuntu 搭建 SonarQube - 建構企業級程式碼品質把關流程：容器化指南"
excerpt: "資訊筆記"
tags: 
- "Linux"
- "Ubuntu"
- "SonarQube"
- "Mysql"
- "Web"
- "Asp.NET Core Web MVC"
- "PostgreSQL"
---
<div class="summary">
<br/>應用所需：1. Linux 主機(本篇 Linux Ubuntu 22.04 作業系統)
<br/>&emsp;&emsp;&emsp;&emsp;&emsp;2. 已安裝 Docker
<br/>&emsp;&emsp;&emsp;&emsp;&emsp;3. 已安裝 Dotnet SDK 8.0 以上版本(本篇範例使用)
<br/>解決問題：如何在 Ubuntu 上搭建 CodeReview 的 Server ，協助檢查代碼品質，讓 CodeReview 可將更多時間關注於產品業務邏輯 (本篇用 DotNet Core)
<br/>&emsp;&emsp;&emsp;&emsp;&emsp;2. 如何使用 SonarQube 排查程式碼
<br/>範例檔案：<a href="https://github.com/gotoa1234/MyBlogExample/tree/main/MinIOWebSiteExample">MinIO WebSite 範例</a>
<br/>基本介紹：本篇分為 4 大部分。
<br/>第一部分：介紹 SonarQube 
<br/>第一部分：安裝 SonarQube 
<br/>第二部分：配置 SonarQube & 說明 PostgreSQL
<br/>第三部分：專案代碼檢查 & 修正
</div>

<div class="title">
    <br/><hr class="titleinner">
	<span></span>
	<hr class="titleinner"><br/>
</div>

<br/><br/>
<h1>第一部分：介紹 SonarQube </h1>

<h2>Step 1：介紹</h2>
官網<a href="https://www.sonarsource.com/products/sonarqube/">SonarQube</a>維護程式品質的伺服器，官方資訊：

```markdown
Your code is a business asset. Achieve the highest value from your code by reaching a state of Clean Code with SonarQube Server.
```

<br/>簡單說：SonarQube 是開源的程式碼質量管理平台，它可以持續分析和測量程式碼的技術品質，從 Bug、代碼氣味（Code Smells）到安全漏洞都能夠進行自動化檢測。
<br/> <img src="/assets/image/Infomation/2025_01_25/001.png" alt="" width="100%" height="100%" />
<br/>



<br/><br/>
<h1>第二部分：安裝 SonarQube </h1>

<h2>Step 1：安裝 Jenkins</h2>
如果已經有 Jenkins Server 可跳過，進入 Ubuntu 輸入以下語法安裝：

``` Shell
sudo apt-get update
docker run -d --name jenkins --rm -p 8180:8080 -p 50000:50000 -v jenkins_home:/var/jenkins_home jenkins/jenkins:lts
```

<br/>其中 -d 一定要有，是為了背景，並且我們會得到 **8180** 的宿主機 Port 號
<br/>





<br/><br/>
<h1>第三部分：配置 SonarQube & 說明 PostgreSQL</h1>

<h2>Step 1：進入容器 - 安裝 dotnet</h2>

``` shell
docker exec -u root -it 7f4e6 bash
apt-get update
apt-get install -y wget apt-transport-https
```

<br/>添加 Microsoft 來源:

``` shell
wget https://packages.microsoft.com/config/ubuntu/22.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
dpkg -i packages-microsoft-prod.deb
rm packages-microsoft-prod.deb
```

<br/>正式安裝 dotnet 8.0 

``` shell
apt-get install -y dotnet-sdk-8.0
```


<br/>我們建立的對象是 Windows Server 因此，要執行黑框的地方
<br/> <img src="/assets/image/Infomation/2025_01_25/001.png" alt="" width="100%" height="100%" />
<br/>






<br/><br/>
<h1>第四部分：專案代碼檢查 & 修正</h1>

<h2>Step 1：創建 Windows Job - 1</h2>
目前 Jenkins Server 上同時擁有 Ubuntu (自已)、Windows 主機，可以依照任務性質來決定建置任務
<br/>新建作業 -> FreeStyleJob -> 輸入 **TestNodeWindows**
<br/> <img src="/assets/image/ContinuousDeployment/Jenkins/2024_12_07/016.png" width="100%" height="100%" />
<br/>

